(this.webpackJsonpwebprojectfrontend=this.webpackJsonpwebprojectfrontend||[]).push([[0],{146:function(t,e,n){t.exports=n(291)},151:function(t,e,n){},270:function(t,e,n){},287:function(t,e,n){},288:function(t,e,n){},291:function(t,e,n){"use strict";n.r(e);var o,i,a,r,d=n(0),c=n.n(d),s=n(26),u=n.n(s),l=n(15),p=n(19),h=n(20),f=n(21),m=n(22),b=n(301),T=n(297),v=n(43),N=(n(151),function(t){function e(){return Object(l.a)(this,e),Object(h.a)(this,Object(f.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(p.a)(e,[{key:"render",value:function(){return c.a.createElement(b.a,{inverted:!0,className:"navBar",fixed:"top"},c.a.createElement(T.a,{className:"navBarContainer"},c.a.createElement(b.a.Item,{header:!0},c.a.createElement(v.a,{className:"logo",name:"sticky note outline"}),"TODO")))}}]),e}(d.Component)),O=n(17),g=n(48),j=n.n(g),y=n(299),D=n(300),C=n(49),k=n(298),E=n(23),_=(n(270),Object(E.b)("store")(o=Object(E.c)(o=function(t){function e(){var t,n;Object(l.a)(this,e);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(n=Object(h.a)(this,(t=Object(f.a)(e)).call.apply(t,[this].concat(i)))).state={todoDescription:n.props.todo.description,todoCheckbox:n.props.todo.isChecked},n.onChange=function(t){n.setState({todoDescription:t.target.value})},n.onEnterDown=function(t){"Enter"===t.key&&(t.preventDefault(),n.onUpdateDescription(),t.target.blur())},n.onUpdateDescription=function(){n.props.todo.description!==n.state.todoDescription&&(n.state.todoDescription.trim()?n.updateTodo(n.state.todoCheckbox):n.props.store.deleteTodo(n.props.noteId,n.props.todo._id))},n.onToggleCheck=function(){var t=!n.state.todoCheckbox;n.setState({todoCheckbox:t}),n.updateTodo(t)},n.updateTodo=function(t){var e=Object(C.a)({},n.props.todo,{description:n.state.todoDescription,isChecked:t});n.props.store.updateTodo(n.props.noteId,e)},n}return Object(m.a)(e,t),Object(p.a)(e,[{key:"componentWillReceiveProps",value:function(t){this.setState({todoDescription:t.todo.description,todoCheckbox:t.todo.isChecked})}},{key:"render",value:function(){return c.a.createElement("div",{className:"todoContainer"},c.a.createElement(k.a,{className:"todoCheckbox",checked:this.state.todoCheckbox,onChange:this.onToggleCheck,disabled:this.props.todo.notSaved}),c.a.createElement(j.a,{className:"customInput todoDescription",html:this.state.todoDescription,onBlur:this.onUpdateDescription,onKeyDown:this.onEnterDown,onChange:this.onChange,disabled:this.props.todo.notSaved}),c.a.createElement(D.a,{className:"deleteTodoButton",circular:!0,icon:"cancel",onClick:this.props.store.deleteTodo.bind(this,this.props.noteId,this.props.todo._id),disabled:this.props.todo.notSaved}))}}]),e}(d.Component))||o)||o),w=function(t){function e(){return Object(l.a)(this,e),Object(h.a)(this,Object(f.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(p.a)(e,[{key:"render",value:function(){var t=this;return this.props.todos.slice().sort((function(t,e){return new Date(t.createdAt)>new Date(e.createdAt)?-1:1})).map((function(e){return c.a.createElement(_,{todo:e,noteId:t.props.noteId})}))}}]),e}(d.Component),S=(n(287),Object(E.b)("store")(i=Object(E.c)(i=function(t){function e(){var t,n;Object(l.a)(this,e);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(n=Object(h.a)(this,(t=Object(f.a)(e)).call.apply(t,[this].concat(i)))).state={newTodoString:"",titleString:n.props.note.title.trim()},n.onChange=function(t,e){n.setState(Object(O.a)({},t,e.target.value))},n.onEnterDown=function(t,e){"Enter"===e.key&&t(e)},n.onUpdateTitle=function(t){n.state.titleString.trim()||n.setState({titleString:""}),n.props.store.updateTitle(n.props.note._id,n.state.titleString),t.target.blur()},n.onAddTodo=function(t){t.preventDefault(),n.state.newTodoString.trim()&&(n.props.store.addTodo(n.props.note._id,n.state.newTodoString),n.setState({newTodoString:""}))},n}return Object(m.a)(e,t),Object(p.a)(e,[{key:"componentWillReceiveProps",value:function(t){this.setState({titleString:t.note.title.trim()})}},{key:"render",value:function(){var t=this.props.note,e=t._id,n=t.todos,o=t.createdAt;return c.a.createElement("div",null,c.a.createElement(y.a,{className:"noteCard"},c.a.createElement(y.a.Content,null,c.a.createElement(j.a,{className:"customInput noteTitle",html:this.state.titleString,placeholder:"Title",onChange:this.onChange.bind(this,"titleString"),onBlur:this.onUpdateTitle,onKeyDown:this.onEnterDown.bind(this,this.onUpdateTitle)}),c.a.createElement(y.a.Meta,{className:"noteDate"},new Date(o).toLocaleDateString()),c.a.createElement(y.a.Description,null,c.a.createElement("div",null,c.a.createElement(v.a,{name:"plus"}),c.a.createElement(j.a,{className:"customInput addTodoInput",html:this.state.newTodoString,placeholder:"New todo",onBlur:this.onAddTodo,onKeyDown:this.onEnterDown.bind(this,this.onAddTodo),onChange:this.onChange.bind(this,"newTodoString")})),c.a.createElement("div",{className:"todoListContainer"},c.a.createElement(w,{todos:n,noteId:e})),c.a.createElement(D.a,{className:"deleteNoteButton",icon:"trash",onClick:this.props.store.deleteNote.bind(this,e),disabled:this.props.note.notSaved})))))}}]),e}(d.Component))||i)||i),A=Object(E.b)("store")(a=Object(E.c)(a=function(t){function e(){return Object(l.a)(this,e),Object(h.a)(this,Object(f.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(p.a)(e,[{key:"render",value:function(){return this.props.store.notes.map((function(t){return c.a.createElement(S,{note:t})}))}}]),e}(d.Component))||a)||a,Q=(n(288),n(289),n(302)),I=Object(E.b)("store")(r=Object(E.c)(r=function(t){function e(){return Object(l.a)(this,e),Object(h.a)(this,Object(f.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(p.a)(e,[{key:"componentDidMount",value:function(){this.props.store.getNotes()}},{key:"render",value:function(){return c.a.createElement("div",{className:"app"},c.a.createElement(N,null),c.a.createElement("div",{className:"navBarPlaceholder"}),c.a.createElement("div",{className:"container"},c.a.createElement(Q.a,{centered:!0},c.a.createElement(A,null)),this.props.store.notes.length<10&&c.a.createElement(D.a,{circular:!0,icon:"plus",className:"addNoteButton",onClick:this.props.store.addNote})))}}]),e}(d.Component))||r)||r,B=n(7),U=new function t(){Object(l.a)(this,t),this.notesQuery="\n        query {\n            notes {\n                _id\n                title\n                todos {\n                    _id\n                    description\n                    isChecked\n                    createdAt\n                }\n                createdAt\n            }\n        }\n    ",this.addNoteQuery="\n        mutation {\n            createNote {\n                _id\n                title\n                todos {\n                    _id\n                    description\n                    isChecked\n                    createdAt\n                }\n                createdAt\n            }\n        }\n    ",this.updateTitleQuery=function(t,e){return'\n        mutation {\n            updateNoteTitle(updatedNote: {\n                _id: "'.concat(t,'",\n                title: "').concat(e,'"\n            }) {\n                _id\n                title\n            }\n        }\n    ')},this.deleteNoteQuery=function(t){return'\n        mutation {\n            deleteNote(noteId: "'.concat(t,'") {\n                _id\n            }\n        }\n    ')}},x=new function t(){Object(l.a)(this,t),this.addTodoQuery=function(t,e){return'\n    mutation {\n        createTodo(newTodo:{description: "'.concat(e,'", todoNote: "').concat(t,'"}) {\n            _id\n            description\n            isChecked\n            todoNote {\n                _id\n            }\n        }\n    }\n')},this.updateTodoQuery=function(t,e,n){return'\n    mutation {\n        updateTodo(updatedTodo: {_id: "'.concat(t,'", description: "').concat(e,'", isChecked: ').concat(n,"}) {\n            _id\n            description\n            todoNote {\n                _id\n            }\n        }\n    }\n")},this.deleteTodoQuery=function(t){return'\n    mutation {\n        deleteTodo(todoId: "'.concat(t,'") {\n            _id\n            todoNote {\n                _id\n            }\n        }\n    }\n')}},P=n(290),q=function t(){var e=this;Object(l.a)(this,t),this.notes=[],this.renderNotes=function(t){t.notes?e.notes=t.notes.slice().sort((function(t,e){return new Date(t.createdAt)>new Date(e.createdAt)?-1:1})):console.log("Get notes: No data retreived from backend.")},this.getNotes=function(){e.dbOperation(U.notesQuery,e.renderNotes)},this.renderAddNote=function(){e.notes.unshift({_id:P(),title:"",todos:[],createdAt:new Date(Date.now()),notSaved:!0})},this.addNote=function(){e.renderAddNote();e.dbOperation(U.addNoteQuery,(function(t){if(t.createNote){var n=t.createNote,o=n._id,i=n.createdAt,a=e.notes.find((function(t){return t.notSaved}));a._id=o,a.createdAt=i,a.notSaved=!1}else console.log("Add note: No data retreived from backend.")}))},this.renderUpdateTitle=function(t,n){var o=e.notes.find((function(e){return t===e._id}));o||console.log("Update title: note not found."),o.title=n},this.updateTitle=function(t,n){var o=e.notes.find((function(e){return t===e._id}));o?o.title!==n&&(e.renderUpdateTitle(t,n),e.dbOperation(U.updateTitleQuery(t,n))):console.log("Update title: note not found.")},this.renderDeleteNote=function(t){var n=!1;e.notes=e.notes.filter((function(e){return n=n||t!==e._id,t!==e._id})),n||console.log("Delete title: note not found.")},this.deleteNote=function(t){e.renderDeleteNote(t),e.dbOperation(U.deleteNoteQuery(t))},this.renderAddTodo=function(t,n){e.notes=e.notes.map((function(e){return t===e._id&&e.todos.unshift({_id:P(),description:n,isChecked:!1,todoNote:e,createdAt:new Date(Date.now()),notSaved:!0}),e}))},this.addTodo=function(t,n){e.renderAddTodo(t,n);e.dbOperation(x.addTodoQuery(t,n),(function(t){if(t.createTodo){var n=t.createTodo,o=n._id,i=n.todoNote,a=n.createdAt,r=e.notes.find((function(t){return t._id===i._id})).todos.find((function(t){return t.notSaved}));r._id=o,r.createdAt=a,r.notSaved=!1}else console.log("Add todo: No data retreived from DB.")}))},this.renderUpdateTodo=function(t,n){var o=e.notes.find((function(e){return t===e._id}));o?o.todos=o.todos.map((function(t){return t._id===n._id?n:t})):console.log("Update todo: Note not found.")},this.updateTodo=function(t,n){e.renderUpdateTodo(t,n),e.dbOperation(x.updateTodoQuery(n._id,n.description,n.isChecked))},this.renderDeleteTodo=function(t,n){var o=e.notes.find((function(e){return t===e._id}));if(o){var i=!1;o.todos=o.todos.filter((function(t){return i=i||n!==t._id,n!==t._id})),i||console.log("Delete todo: Todo not found.")}else console.log("Delete todo: Note not found.")},this.deleteTodo=function(t,n){e.renderDeleteTodo(t,n),e.dbOperation(x.deleteTodoQuery(n),null)},this.dbOperation=function(t,e){fetch("https://todoprojectbackend.herokuapp.com/graphql",{method:"POST",body:JSON.stringify({query:t}),headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("DB operation failed. \nQuery: \n"+t);return e.json()})).then((function(t){e&&e(t.data)})).catch((function(e){console.log("DB operation failed. \nQuery: \n"+t),console.log(e)}))}};Object(B.j)(q,{notes:B.o,getNotes:B.f,addNote:B.f,updateTitle:B.f,deleteNote:B.f,addTodo:B.f,updateTodo:B.f,deleteTodo:B.f});var J=new q,K=c.a.createElement(E.a,{store:J},c.a.createElement(I,null));u.a.render(K,document.getElementById("root"))}},[[146,1,2]]]);
//# sourceMappingURL=main.d64c2490.chunk.js.map