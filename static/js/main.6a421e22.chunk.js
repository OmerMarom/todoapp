(this.webpackJsonpwebprojectfrontend=this.webpackJsonpwebprojectfrontend||[]).push([[0],{144:function(e,t,o){e.exports=o(289)},149:function(e,t,o){},269:function(e,t,o){},286:function(e,t,o){},287:function(e,t,o){},289:function(e,t,o){"use strict";o.r(t);var n,i,a,r,d=o(0),c=o.n(d),s=o(26),l=o.n(s),u=o(15),p=o(19),h=o(20),f=o(21),m=o(22),g=o(299),b=o(295),T=o(43),N=(o(149),function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return c.a.createElement(g.a,{inverted:!0,className:"navBar",fixed:"top"},c.a.createElement(b.a,{className:"navBarContainer"},c.a.createElement(g.a.Item,{header:!0},c.a.createElement(T.a,{className:"logo",name:"sticky note outline"}),"TODO")))}}]),t}(d.Component)),O=o(17),k=o(48),v=o.n(k),C=o(297),_=o(298),j=o(296),y=o(23),D=(o(269),Object(y.b)("store")(n=Object(y.c)(n=function(e){function t(){var e,o;Object(u.a)(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(o=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(i)))).state={todoDescription:o.props.todo.description,todoCheckbox:o.props.todo.isChecked},o.onChange=function(e){o.setState({todoDescription:e.target.value})},o.onEnterDown=function(e){"Enter"===e.key&&(e.preventDefault(),o.onUpdateDescription(e),e.target.blur())},o.onUpdateDescription=function(e){o.props.todo.description!==o.state.todoDescription&&(o.state.todoDescription.trim()?o.props.store.updateTodo(o.props.todo._id,o.state.todoDescription):o.props.store.deleteTodo(o.props.todo._id))},o.onToggleCheck=function(e){var t=!o.state.todoCheckbox;o.setState({todoCheckbox:t}),o.props.store.toggleCheck(o.props.todo._id,t)},o}return Object(m.a)(t,e),Object(p.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({todoDescription:e.todo.description,todoCheckbox:e.todo.isChecked})}},{key:"render",value:function(){return c.a.createElement("div",{className:"todoContainer"},c.a.createElement(j.a,{className:"todoCheckbox",checked:this.state.todoCheckbox,onChange:this.onToggleCheck}),c.a.createElement(v.a,{className:"customInput todoDescription",html:this.state.todoDescription,onBlur:this.onUpdateDescription,onKeyDown:this.onEnterDown,onChange:this.onChange}),c.a.createElement(_.a,{className:"deleteTodoButton",circular:!0,icon:"cancel",onClick:this.props.store.deleteTodo.bind(this,this.props.todo._id)}))}}]),t}(d.Component))||n)||n),E=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return this.props.todos.slice().sort((function(e,t){return new Date(e.createdAt)>new Date(t.createdAt)?-1:1})).map((function(t){return c.a.createElement(D,{todo:t,noteId:e.props.noteId})}))}}]),t}(d.Component),w=(o(286),Object(y.b)("store")(i=Object(y.c)(i=function(e){function t(){var e,o;Object(u.a)(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(o=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(i)))).state={newTodoString:"",titleString:o.props.note.title.trim()},o.onChange=function(e,t){o.setState(Object(O.a)({},e,t.target.value))},o.onEnterDown=function(e,t){"Enter"===t.key&&e(t)},o.onUpdateTitle=function(e){o.state.titleString.trim()||o.setState({titleString:""}),o.props.store.updateTitle(o.props.note._id,o.state.titleString),e.target.blur()},o.onAddTodo=function(e){e.preventDefault(),o.state.newTodoString.trim()&&(o.props.store.addTodo(o.props.note._id,o.state.newTodoString),o.setState({newTodoString:""}))},o}return Object(m.a)(t,e),Object(p.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({titleString:e.note.title.trim()})}},{key:"render",value:function(){var e=this.props.note,t=e._id,o=e.todos,n=e.createdAt;return c.a.createElement("div",null,c.a.createElement(C.a,{className:"noteCard"},c.a.createElement(C.a.Content,null,c.a.createElement(v.a,{className:"customInput noteTitle",html:this.state.titleString,placeholder:"Title",onChange:this.onChange.bind(this,"titleString"),onBlur:this.onUpdateTitle,onKeyDown:this.onEnterDown.bind(this,this.onUpdateTitle)}),c.a.createElement(C.a.Meta,{className:"noteDate"},new Date(n).toLocaleDateString()),c.a.createElement(C.a.Description,null,c.a.createElement("div",null,c.a.createElement(T.a,{name:"plus"}),c.a.createElement(v.a,{className:"customInput addTodoInput",html:this.state.newTodoString,placeholder:"New todo",onBlur:this.onAddTodo,onKeyDown:this.onEnterDown.bind(this,this.onAddTodo),onChange:this.onChange.bind(this,"newTodoString")})),c.a.createElement("div",{className:"todoListContainer"},c.a.createElement(E,{todos:o,noteId:t})),c.a.createElement(_.a,{className:"deleteNoteButton",icon:"trash",onClick:this.props.store.deleteNote.bind(this,t)})))))}}]),t}(d.Component))||i)||i),S=Object(y.b)("store")(a=Object(y.c)(a=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return this.props.store.notes.map((function(e){return c.a.createElement(w,{note:e})}))}}]),t}(d.Component))||a)||a,A=(o(287),o(288),o(300)),Q=Object(y.b)("store")(r=Object(y.c)(r=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.props.store.getNotes()}},{key:"render",value:function(){return c.a.createElement("div",{className:"app"},c.a.createElement(N,null),c.a.createElement("div",{className:"navBarPlaceholder"}),c.a.createElement("div",{className:"container"},c.a.createElement(A.a,{centered:!0},c.a.createElement(S,null)),this.props.store.notes.length<10&&c.a.createElement(_.a,{circular:!0,icon:"plus",className:"addNoteButton",onClick:this.props.store.addNote})))}}]),t}(d.Component))||r)||r,B=o(6),I=new function e(){Object(u.a)(this,e),this.notesQuery="\n        query {\n            notes {\n                _id\n                title\n                todos {\n                    _id\n                    description\n                    isChecked\n                    createdAt\n                }\n                createdAt\n            }\n        }\n    ",this.addNoteQuery="\n        mutation {\n            createNote {\n                _id\n                title\n                todos {\n                    _id\n                    description\n                    isChecked\n                    createdAt\n                }\n                createdAt\n            }\n        }\n    ",this.updateTitleQuery=function(e,t){return'\n        mutation {\n            updateNoteTitle(updatedNote: {\n                _id: "'.concat(e,'",\n                title: "').concat(t,'"\n            }) {\n                _id\n                title\n            }\n        }\n    ')},this.deleteNoteQuery=function(e){return'\n        mutation {\n            deleteNote(noteId: "'.concat(e,'") {\n                _id\n            }\n        }\n    ')}},U=new function e(){Object(u.a)(this,e),this.addTodoQuery=function(e,t){return'\n    mutation {\n        createTodo(newTodo:{description: "'.concat(t,'", todoNote: "').concat(e,'"}) {\n            _id\n            description\n            isChecked\n            todoNote {\n                _id\n            }\n        }\n    }\n')},this.updateTodoQuery=function(e,t){return'\n    mutation {\n        updateTodoDescription(updatedTodo: {_id: "'.concat(e,'", description: "').concat(t,'"}) {\n            _id\n            description\n            todoNote {\n                _id\n            }\n        }\n    }\n')},this.toggleCheckQuery=function(e,t){return'\n    mutation {\n        toggleTodoCheck(updatedTodo: {_id: "'.concat(e,'", isChecked: ').concat(t,"}) {\n            _id\n            isChecked\n            todoNote {\n                _id\n            }\n        }\n    }\n")},this.deleteTodoQuery=function(e){return'\n    mutation {\n        deleteTodo(todoId: "'.concat(e,'") {\n            _id\n            todoNote {\n                _id\n            }\n        }\n    }\n')}},x=function e(){var t=this;Object(u.a)(this,e),this.notes=[],this.getNotes=function(){t.dbOperation(I.notesQuery,(function(e){e.notes?t.notes=e.notes.slice().sort((function(e,t){return new Date(e.createdAt)>new Date(t.createdAt)?-1:1})):console.log("Get notes: No data retreived from backend.")}))},this.addNote=function(){t.dbOperation(I.addNoteQuery,(function(e){e.createNote?t.notes.unshift({_id:e.createNote._id,title:e.createNote.title,todos:e.createNote.todos,createdAt:e.createNote.createdAt}):console.log("Add note: No data retreived from backend.")}))},this.updateTitle=function(e,o){var n=t.notes.find((function(t){return e===t._id}));if(n){if(n.title!==o){t.dbOperation(I.updateTitleQuery(e,o),(function(e){var o=t.notes.find((function(t){return e.updateNoteTitle._id===t._id}));o||console.log("Update title: note not found."),o.title=e.updateNoteTitle.title}))}}else console.log("Update title: note not found.")},this.deleteNote=function(e){t.dbOperation(I.deleteNoteQuery(e),(function(e){e.deleteNote?t.notes=t.notes.filter((function(t){return t._id!==e.deleteNote._id})):console.log("Delete note: No data retreived from DB.")}))},this.addTodo=function(e,o){t.dbOperation(U.addTodoQuery(e,o),(function(e){if(e.createTodo){var o=e.createTodo,n=o._id,i=o.description,a=o.isChecked,r=o.todoNote,d=o.createdAt;t.notes=t.notes.map((function(e){return e._id===r._id&&e.todos.unshift({_id:n,description:i,isChecked:a,todoNote:r._id,createdAt:d}),e}))}else console.log("Add todo: No data retreived from DB.")}))},this.updateTodo=function(e,o){t.dbOperation(U.updateTodoQuery(e,o),(function(e){if(e.updateTodoDescription){var o=e.updateTodoDescription,n=o._id,i=o.description,a=o.todoNote,r=t.notes.find((function(e){return a._id===e._id}));if(r){var d=r.todos.find((function(e){return n===e._id}));d?d.description=i:console.log("Update todo: Todo not found.")}else console.log("Update todo: Note not found.")}else console.log("Update todo: No data retreived from DB.")}))},this.toggleCheck=function(e,o){t.dbOperation(U.toggleCheckQuery(e,o),(function(e){if(e.toggleTodoCheck){var o=e.toggleTodoCheck,n=o._id,i=o.isChecked,a=o.todoNote,r=t.notes.find((function(e){return a._id===e._id}));if(r){var d=r.todos.find((function(e){return n===e._id}));d?d.isChecked=i:console.log("Toggle check: Todo not found.")}else console.log("Toggle check: Note not found.")}else console.log("Toggle check: No data retreived from DB.")}))},this.deleteTodo=function(e){t.dbOperation(U.deleteTodoQuery(e),(function(e){if(e.deleteTodo){var o=t.notes.find((function(t){return t._id===e.deleteTodo.todoNote._id}));if(o){var n=!1;o.todos=o.todos.filter((function(t){return n=n||t._id!==e.deleteTodo._id,t._id!==e.deleteTodo._id})),n||console.log("Delete todo: Todo not found.")}else console.log("Delete todo: Note not found.")}else console.log("Delete todo: No data retreived from DB.")}))},this.dbOperation=function(e,t){fetch("https://todoprojectbackend.herokuapp.com/graphql",{method:"POST",body:JSON.stringify({query:e}),headers:{"Content-Type":"application/json"}}).then((function(t){if(200!==t.status&&201!==t.status)throw new Error("DB operation failed. \nQuery: \n"+e);return t.json()})).then((function(e){t&&t(e.data)})).catch((function(t){console.log("DB operation failed. \nQuery: \n"+e),console.log(t)}))}};Object(B.j)(x,{notes:B.o,getNotes:B.f,addNote:B.f,updateTitle:B.f,deleteNote:B.f,addTodo:B.f,updateTodo:B.f,toggleCheck:B.f,deleteTodo:B.f});var P=new x,q=c.a.createElement(y.a,{store:P},c.a.createElement(Q,null));l.a.render(q,document.getElementById("root"))}},[[144,1,2]]]);
//# sourceMappingURL=main.6a421e22.chunk.js.map